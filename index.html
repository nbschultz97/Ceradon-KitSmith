<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ceradon KitSmith</title>
  <link rel="stylesheet" href="styles.css">
  <script src="mission_project.js"></script>
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    #access-gate {
      max-width: 560px;
      margin: 10vh auto 4rem;
      padding: 1.5rem 1.75rem;
      background: #ffffff;
      border: 1px solid #e2e4e9;
      border-radius: 12px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
      display: none;
    }

    #access-gate h1 {
      margin: 0 0 0.25rem;
      font-size: 1.5rem;
    }

    #access-gate p {
      margin: 0 0 1rem;
      color: #4a4f5a;
    }

    #access-gate label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    #access-gate input[type="password"] {
      width: 100%;
      padding: 0.65rem 0.75rem;
      border-radius: 8px;
      border: 1px solid #c7ccd6;
      font-size: 1rem;
      margin-top: 0.25rem;
    }

    #access-gate button {
      margin-top: 0.75rem;
      padding: 0.65rem 1rem;
      background: #1f6feb;
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
    }

    #access-gate button:hover {
      background: #1a5dc5;
    }

    #demo-error {
      margin-top: 0.5rem;
      color: #b42318;
      background: #fef3f2;
      border: 1px solid #fecdca;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      display: none;
      font-size: 0.95rem;
    }

    #app-root {
      display: none;
    }

    .status-banner {
      margin: 1rem auto 0.5rem;
      max-width: 1180px;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      border: 1px solid #d0d7de;
      background: #f6f8fa;
      color: #1f2933;
    }

    .status-banner[data-tone="warning"] {
      border-color: #fcd34d;
      background: #fffbeb;
      color: #92400e;
    }

    .status-banner[data-tone="error"] {
      border-color: #fca5a5;
      background: #fef2f2;
      color: #991b1b;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="sha512-Fs5INomIQhR6CP3+xwlv6xLUOKUzYZdqzwc+ZZq0VEEv1pn6gGGY10m1HzFqp2saojlYCHGmDJtrvlaK0qIItw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <section id="demo-request" class="demo-request" aria-labelledby="demo-request-heading">
    <div class="demo-request-inner">
      <h2 id="demo-request-heading">Request a demo code</h2>
      <p>
        Ceradon Systems provides controlled access to <strong>Ceradon KitSmith</strong> (Architect Stack demos) for qualified
        organizations. Request a demo code to explore the live planner and see how it fits your mission profiles.
      </p>
      <div class="demo-request-actions">
        <a
          id="demo-request-button"
          class="btn-primary demo-request-btn"
          href="mailto:contact@ceradonsystems.com?subject=Demo%20code%20request%20%E2%80%93%20Ceradon%20KitSmith&body=Hi%20Ceradon%20team,%0D%0A%0D%0AI'd%20like%20to%20request%20a%20demo%20access%20code%20for%20Ceradon%20KitSmith.%0D%0A%0D%0AOrganization:%20%0D%0AUse%20case:%20%0D%0ATimeline:%20%0D%0A%0D%0AThank%20you.">
          Request a demo code
        </a>

        <p class="demo-request-email">
          Or email us at
          <a href="mailto:contact@ceradonsystems.com?subject=Demo%20code%20request%20%E2%80%93%20Ceradon%20KitSmith">contact@ceradonsystems.com</a>
          with your organization and use case.
        </p>
      </div>
    </div>
  </section>

  <div id="access-gate" role="region" aria-label="Access code gate">
    <h1>Ceradon Systems — Ceradon KitSmith Demo</h1>
    <p>Ceradon KitSmith is the sustainment/ruck planning component of the Ceradon Architect COTS planning suite.</p>
    <p>Enter your demo access code to continue.</p>
    <label for="demo-code">Access code</label>
    <input id="demo-code" type="password" name="demo-code" autocomplete="off" inputmode="text" />
    <button id="demo-enter" type="button">Enter</button>
    <div id="demo-error" aria-live="polite">Invalid code. Please check and try again.</div>
  </div>

  <div id="app-root">
    <header class="top-bar">
      <div class="brand">
        <div class="brand-title">Ceradon KitSmith</div>
        <p class="brand-subtitle">Kit &amp; sustainment planner</p>
      </div>
      <div class="version-chip" id="header-version"></div>
      <nav class="top-nav" aria-label="Primary">
        <button class="nav-link" type="button" data-scroll="#constraints">Constraints</button>
        <button class="nav-link" type="button" data-scroll="#inventory">Inventory</button>
        <button class="nav-link" type="button" data-scroll="#kits">Kits</button>
        <button class="nav-link" type="button" data-scroll="#summary">Summary</button>
        <button class="nav-link" type="button" data-scroll="#packing-lists">Packing Lists</button>
        <button class="nav-link" type="button" data-scroll="#export">Export</button>
      </nav>
      <div class="top-actions">
        <button id="import-mission-project" class="btn-ghost" type="button">Import MissionProject</button>
        <button id="export-mission-project" class="btn-primary" type="button">Export MissionProject</button>
      </div>
    </header>

    <div id="status-banner" class="status-banner" hidden aria-live="polite"></div>

    <main class="layout">
      <section id="constraints" class="panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 1 · Mission inputs</p>
            <h2>Define mission</h2>
          </div>
          <div class="preset-actions">
            <button id="demo-recon" class="btn-ghost" type="button">Load 24h Recon Patrol</button>
            <button id="demo-uxs" class="btn-ghost" type="button">Load 48h UxS-Heavy Mission</button>
            <button id="demo-sustainment" class="btn-ghost" type="button">Load demo sustainment scenario</button>
            <button id="demo-whitefrost" class="btn-primary" type="button">Load WHITEFROST Demo</button>
            <button id="reset-constraints" class="btn-ghost" type="button">Reset to Blank</button>
          </div>
        </div>
        <div class="hint-panel">
          <p class="eyebrow">Cold-weather and LSCO sustainment</p>
          <p>Use the 24/48/72h presets and the Whitefrost demo as starting points for extended, contested operations while keeping loads COTS-focused and power-aware.</p>
        </div>
        <div id="mission-project-status" aria-live="polite"></div>
        <form id="constraints-form" class="form-grid" aria-label="Constraints">
          <div class="subsection">
            <p class="eyebrow">Mission profile</p>
            <div class="form-grid">
              <label>
                Mission Duration (hours)
                <input type="number" name="durationHours" min="1" list="duration-presets" value="24" />
                <datalist id="duration-presets">
                  <option value="24">24 hrs</option>
                  <option value="48">48 hrs</option>
                  <option value="72">72 hrs</option>
                </datalist>
              </label>
              <label>
                Environment
                <select name="environment">
                  <option value="Urban">Urban</option>
                  <option value="Rural">Rural</option>
                  <option value="Mountain">Mountain</option>
                  <option value="Arctic">Arctic</option>
                  <option value="Maritime">Maritime</option>
                  <option value="Desert">Desert</option>
                </select>
              </label>
              <label>
                Altitude (m)
                <input type="number" step="10" name="altitudeM" placeholder="e.g., 2200" />
              </label>
              <label>
                Temperature (°C)
                <input type="number" step="1" name="temperatureC" placeholder="e.g., -15" />
              </label>
            </div>
          </div>
          <div class="subsection">
            <p class="eyebrow">Team</p>
            <div class="form-grid">
              <label>
                Team Size
                <input type="number" name="teamSize" min="1" value="4" />
              </label>
              <label>
                Max Weight per Operator (kg)
                <input type="number" step="0.5" min="0" name="maxWeightPerOperatorKg" value="22" />
              </label>
            </div>
          </div>
          <div class="subsection">
            <p class="eyebrow">Limits &amp; power</p>
            <div class="form-grid">
              <label>
                Safety factor
                <input type="number" step="0.05" min="1" name="safetyFactor" value="1.2" />
              </label>
              <fieldset class="stack">
                <legend>Power Strategy</legend>
                <label class="checkbox">
                  <input type="checkbox" name="powerExternal" />
                  External charging available
                </label>
                <label class="checkbox">
                  <input type="checkbox" name="powerGenerator" />
                  Bring generator
                </label>
                <label class="checkbox">
                  <input type="checkbox" name="powerBatteryOnly" checked />
                  Battery-only
                </label>
              </fieldset>
              <label class="full-width">
                Notes
                <textarea name="notes" rows="3" placeholder="Lane, AO, remarks..."></textarea>
              </label>
            </div>
          </div>
          <div class="subsection">
            <p class="eyebrow">MissionProject-first imports</p>
            <div class="form-grid">
              <p class="muted full-width">Architect hub and Mission Architect are the recommended sources for a gold MissionProject JSON. Use these helpers to merge designs and mission metadata into the same envelope.</p>
              <label class="full-width">
                Load Node/Platform designs JSON
                <input type="file" id="design-import" accept="application/json" />
              </label>
              <label class="full-width">
                Load Mission metadata JSON
                <input type="file" id="mission-import" accept="application/json" />
              </label>
              <label class="full-width">
                Load MissionProject JSON
                <input type="file" id="mission-project-import" accept="application/json" />
              </label>
              <p class="muted full-width">Use MissionProject import as the primary entry point. Node/Platform and mission metadata helpers merge into the active MissionProject for refinements.</p>
            </div>
          </div>
        </form>
        <div class="snapshot" id="mission-snapshot" aria-live="polite"></div>
      </section>

      <section id="inventory" class="panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 2 · Loadout source</p>
            <h2>Inventory</h2>
          </div>
          <div class="filters sticky-filter">
            <div class="filter-buttons" id="category-buttons" aria-label="Category filters"></div>
            <input id="filter-text" type="search" placeholder="Search name or tag" />
            <div id="inventory-count" class="muted"></div>
          </div>
        </div>
        <div id="inventory-list" class="card-grid" aria-live="polite"></div>
      </section>

      <section id="kits" class="panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 3 · Build kits</p>
            <h2>Kits</h2>
          </div>
          <div class="kit-actions">
            <button id="add-kit" class="btn-primary" type="button">Add Kit</button>
          </div>
        </div>
        <div id="kit-form" class="kit-form" hidden>
          <label>
            Kit name
            <input type="text" id="kit-name-input" placeholder="RTO, TL, Vehicle" />
          </label>
          <label>
            Role
            <input type="text" id="kit-role-input" placeholder="Comms, Security..." />
          </label>
          <div class="kit-form-actions">
            <button id="save-kit" class="btn-primary" type="button">Create</button>
            <button id="cancel-kit" class="btn-ghost" type="button">Cancel</button>
          </div>
        </div>
        <div id="kits-container" class="stack"></div>
      </section>

      <section id="summary" class="panel summary-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 4 · Rollup</p>
            <h2>Summary</h2>
          </div>
        </div>
        <div id="summary-content" class="stack"></div>
      </section>

      <section id="packing-lists" class="panel summary-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 5 · Pack &amp; assign</p>
            <h2>Packing Lists</h2>
          </div>
          <div class="summary-actions">
            <button id="add-operator" class="btn-ghost" type="button">Add Operator</button>
            <button id="print-packing" class="btn-primary" type="button">Print Packing Lists</button>
          </div>
        </div>
        <div id="packing-lists-content" class="stack"></div>
      </section>

      <section id="export" class="panel summary-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Step 6 · Share</p>
            <h2>Export</h2>
          </div>
          <div class="summary-actions">
            <button id="copy-checklist" class="btn-ghost" type="button">Copy Text Checklist</button>
            <button id="download-json" class="btn-ghost" type="button">Download JSON</button>
            <button id="download-mission-project" class="btn-ghost" type="button">Export MissionProject JSON</button>
            <button id="download-atak" class="btn-primary" type="button">Download ATAK Mission Package (.zip)</button>
          </div>
        </div>
        <div id="export-content" class="stack"></div>
        <div id="clipboard-status" class="muted" role="status" aria-live="polite"></div>
      </section>
      <section id="change-log" class="panel changelog-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Release notes</p>
            <h2>Change Log</h2>
          </div>
        </div>
        <div id="change-log-entries" class="stack"></div>
      </section>
    </main>

    <footer class="footer-bar">
      <div class="footer-content">
        <span id="footer-version"></span>
      </div>
    </footer>

    <template id="kit-template">
      <div class="kit-card">
        <div class="kit-header">
          <div>
            <input class="kit-name" type="text" aria-label="Kit name" />
            <input class="kit-role" type="text" aria-label="Kit role" placeholder="Role" />
          </div>
          <div class="kit-status">
            <span class="badge status-badge">Status</span>
            <button class="btn-ghost remove-kit" type="button">Remove</button>
          </div>
        </div>
        <div class="kit-body">
          <div class="kit-stats">
            <div class="stat-block">
              <p class="muted">Weight</p>
              <div class="stat-value"><span class="kit-weight">0</span> kg</div>
            </div>
            <div class="stat-block">
              <p class="muted">Energy</p>
              <div class="stat-value"><span class="kit-energy">0</span> Wh</div>
            </div>
            <div class="stat-block">
              <p class="muted">Runtime</p>
              <div class="stat-value kit-runtime">--</div>
            </div>
          </div>
          <ul class="kit-items"></ul>
          <p class="kit-empty">No items yet. Add from inventory.</p>
        </div>
        <div class="kit-footer">
          <div class="badge badge-ghost kit-weight-badge">Weight status</div>
          <div class="badge badge-ghost kit-power-badge">Power status</div>
        </div>
      </div>
    </template>
  </div>

  <script src="app.js"></script>
  <script>
    (function () {
      const ACCESS_CODE = "KIT-FORGE-219";
      const STORAGE_KEY = "ceradon_demo_code";

      const gate = document.getElementById("access-gate");
      const appRoot = document.getElementById("app-root");
      const input = document.getElementById("demo-code");
      const enterButton = document.getElementById("demo-enter");
      const error = document.getElementById("demo-error");
      const demoRequest = document.getElementById("demo-request");

      function showGate() {
        gate.style.display = "block";
        appRoot.style.display = "none";
        if (demoRequest) demoRequest.style.display = "block";
      }

      function showApp() {
        gate.style.display = "none";
        appRoot.style.display = "block";
        if (demoRequest) demoRequest.style.display = "none";
      }

      function validateCode() {
        const value = (input.value || "").trim();
        if (value === ACCESS_CODE) {
          localStorage.setItem(STORAGE_KEY, value);
          error.style.display = "none";
          showApp();
        } else {
          error.style.display = "block";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const cachedCode = localStorage.getItem(STORAGE_KEY);
        if (cachedCode) {
          input.value = cachedCode;
          if (cachedCode === ACCESS_CODE) {
            showApp();
            return;
          }
        }

        showGate();
        input.focus();

        enterButton.addEventListener("click", validateCode);
        input.addEventListener("keydown", (event) => {
          if (event.key === "Enter") {
            event.preventDefault();
            validateCode();
          }
        });
      });
    })();
  </script>
</body>
</html>
